(function(){
'use strict';var rLb=function(a){return PENPOT.fw(function(b){var c=new Image;PENPOT.Nu(c,"onload",function(){b.next(c);return b.complete()});PENPOT.Nu(c,"crossOrigin","anonymous");PENPOT.Nu(c,"onerror",function(d){return b.error(d)});PENPOT.Nu(c,"onabort",function(){return b.error(PENPOT.fh("operation aborted",PENPOT.Nh.d_(PENPOT.t([new PENPOT.k(null,3,[PENPOT.Qh,PENPOT.pUa,PENPOT.mn,PENPOT.qUa,PENPOT.zq,"operation aborted"],null),null])),null))});PENPOT.Nu(c,"src",a);return function(){PENPOT.Nu(c,
"src","");PENPOT.Nu(c,"onload",null);PENPOT.Nu(c,"onerror",null);return PENPOT.Nu(c,"onabort",null)}})},sLb=function(a,b,c){var d=a/b;return a<b?new PENPOT.A(null,2,5,PENPOT.D,[c,1/d*c],null):new PENPOT.A(null,2,5,PENPOT.D,[c*d,c],null)},uLb=function(a){if(PENPOT.m(tLb.has(a))){var b=tLb.get(a);return PENPOT.hw(b.text())}return PENPOT.vw(function(c){return c==null?(0,PENPOT.Xw)(a):PENPOT.yw(function(d){return tLb.set(a,PENPOT.uUa(d,"text/plain"))},PENPOT.vw(PENPOT.tUa,(0,PENPOT.Xw)(PENPOT.Dj.b_(c))))},
PENPOT.xw(function(c){if(PENPOT.Hu("app.rasterizer",PENPOT.ik)){var d=function(){return new PENPOT.Rg(function(){return new PENPOT.A(null,1,5,PENPOT.D,[new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.zq,"fetching data uri"],null)],null)})}(),e=PENPOT.Ju();PENPOT.Eu(function(){var f=PENPOT.Qb(d),h=PENPOT.Kf.a_(PENPOT.nC,f);f=PENPOT.ov.b_(PENPOT.Nh.d_(PENPOT.t([null,null])));var l=new PENPOT.k(null,7,[PENPOT.cE,f,PENPOT.dE,e,PENPOT.eE,h,PENPOT.fE,PENPOT.Ln(),PENPOT.gE,new PENPOT.Rg(function(){return PENPOT.Iu(h)}),
PENPOT.hE,"app.rasterizer",PENPOT.iE,PENPOT.ik],null);f=function(){return c!=null?PENPOT.y.d_(l,PENPOT.jE,c,PENPOT.t([PENPOT.b3a,new PENPOT.Rg(function(){return c.stack})])):l}();return PENPOT.Ug.a_(PENPOT.kE,PENPOT.Ge(f))})}return(0,PENPOT.Xw)(null)},PENPOT.cx(new PENPOT.k(null,5,[PENPOT.Yw,a,PENPOT.bx,PENPOT.$E,PENPOT.ll,PENPOT.BB,PENPOT.Qs,PENPOT.dVa,PENPOT.eVa,!0],null))))},vLb=function(a){var b=PENPOT.Ow(a,"href");return PENPOT.m(b)?PENPOT.yi(b,"data:")?(0,PENPOT.Xw)(a):PENPOT.tw(function(c){PENPOT.Tw(a,
"href",c);return a},uLb(b)):PENPOT.iw()},wLb=function(a,b){var c=a.documentElement;var d=a.createElementNS("http://www.w3.org/2000/svg","style");PENPOT.Qw(d,a.createTextNode(b));return PENPOT.Qw(c,d)},xLb=function(a){return PENPOT.ww(function(b,c){var d=PENPOT.v(c,0,null);c=PENPOT.v(c,1,null);return PENPOT.Di(b,d,c)},a,PENPOT.vw(function(b){return PENPOT.tw(function(c){return new PENPOT.A(null,2,5,PENPOT.D,[b,c],null)},uLb(b))},PENPOT.tw(PENPOT.Kc,PENPOT.hw(PENPOT.Dg(/url\((https?:\/\/[^)]+)\)/,a)))))},
yLb=function(a){return PENPOT.zw(PENPOT.vw(function(b){var c=PENPOT.Ow(b,"style");return PENPOT.yw(function(d){return PENPOT.Tw(b,"style",d)},xLb(c))},PENPOT.hw(PENPOT.RUa(a,"[style]"))))},zLb=function(a){return PENPOT.zw(PENPOT.vw(function(b){return PENPOT.yw(function(c){return PENPOT.SUa(b,c)},xLb(PENPOT.Sw(b)))},PENPOT.hw(PENPOT.RUa(a,"style"))))},ALb=function(a,b){return PENPOT.kw(PENPOT.zw(PENPOT.vw(vLb,PENPOT.hw(PENPOT.RUa(a,"image")))),PENPOT.zw(PENPOT.yw(PENPOT.He(wLb,a),xLb(b))),yLb(a),zLb(a),
(0,PENPOT.Xw)(a))},BLb=function(a){return(new DOMParser).parseFromString(a,"image/svg+xml")},CLb=function(a){a=a.documentElement;return(new XMLSerializer).serializeToString(a)},DLb=function(a,b,c){a=BLb(a);return PENPOT.tw(CLb,PENPOT.tw(function(d){var e=d.documentElement;var f=d.documentElement;var h=PENPOT.Ow(f,"width");f=PENPOT.Ow(f,"height");PENPOT.mj(h,f)?(f=d.documentElement,h=PENPOT.Ow(f,"width"),f=PENPOT.Ow(f,"height"),h=sLb(PENPOT.kj(h,0),PENPOT.kj(f,0),c)):(h=PENPOT.Ow(d.documentElement,
"viewBox"),typeof h==="string"?(f=PENPOT.Ei(h,/\s+/),PENPOT.v(f,0,null),PENPOT.v(f,1,null),h=PENPOT.v(f,2,null),f=PENPOT.v(f,3,null),h=sLb(PENPOT.kj(h,0),PENPOT.kj(f,0),c)):h=null);f=h;h=PENPOT.v(f,0,null);f=PENPOT.v(f,1,null);PENPOT.Tw(e,"width",""+(h??""));PENPOT.Tw(e,"height",""+(f??""));return d},ALb(a,b)))},ELb=function(a){return PENPOT.fw(function(b){var c=PENPOT.aC.createElement("canvas");c.width=a.width;c.height=a.height;c.getContext("bitmaprenderer").transferFromImageBitmap(a);c.toBlob(function(d){b.next(d);
return b.complete()});return PENPOT.Ge(null)})},FLb=function(a){var b=a.data,c=a.styles,d=PENPOT.wq.a_(a.width,300),e=PENPOT.wq.a_(a.quality,"medium");return PENPOT.vw(function(f){return PENPOT.yw(function(){return PENPOT.vUa(f)},PENPOT.vw(function(h){var l={resizeWidth:d,resizeQuality:e};var n=h.width;var u=h.height;if("OffscreenCanvas"in window)n=new OffscreenCanvas(n,u);else{var z=document.createElement("canvas");PENPOT.Nu(z,"width",n);PENPOT.Nu(z,"height",u);n=z}n.getContext("2d").drawImage(h,
0,0);return createImageBitmap(n,l)},rLb(f)))},PENPOT.tw(PENPOT.wUa,PENPOT.tw(function(f){return PENPOT.uUa(f,"image/svg+xml")},DLb(b,c,d))))},JLb=function(a){var b=a.data;if(PENPOT.yi(GLb,a.origin)){var c=b.id;a=b.payload;b=b.scope;if(a!=null&&PENPOT.r.a_(b,"penpot/rasterizer")){b=PENPOT.He(HLb,c);c=PENPOT.He(ILb,c);a:switch(PENPOT.wq.a_(a.result,"blob")){case "image-bitmap":a=FLb(a);break a;default:a=PENPOT.vw(ELb,FLb(a))}a=PENPOT.fUa(a,b,c)}else a=null;return a}return null},KLb=function(a,b,c){a=
{id:a,type:b,scope:"penpot/rasterizer",payload:c};return window===parent?null:c instanceof ImageBitmap?parent.postMessage(a,GLb,[c]):parent.postMessage(a,GLb)},HLb=function(a,b){return KLb(a,"success",b)},ILb=function(a,b){return KLb(a,"failure",PENPOT.ih(b))},MLb=function(){window.addEventListener("message",JLb);KLb(null,"ready",null);if(PENPOT.Hu("app.rasterizer",PENPOT.zj)){var a=function(){return new PENPOT.Rg(function(){return new PENPOT.A(null,3,5,PENPOT.D,[new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.zq,
"initialized"],null),new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.Cyb,""+(PENPOT.Tu??"")],null),new PENPOT.A(null,2,5,PENPOT.D,[LLb,""+(GLb??"")],null)],null)})}(),b=PENPOT.Ju();PENPOT.Eu(function(){var c=PENPOT.Qb(a),d=PENPOT.Kf.a_(PENPOT.nC,c);c=PENPOT.ov.b_(PENPOT.Nh.d_(PENPOT.t([null,null])));c=new PENPOT.k(null,7,[PENPOT.cE,c,PENPOT.dE,b,PENPOT.eE,d,PENPOT.fE,PENPOT.Ln(),PENPOT.gE,new PENPOT.Rg(function(){return PENPOT.Iu(d)}),PENPOT.hE,"app.rasterizer",PENPOT.iE,PENPOT.zj],null);return PENPOT.Ug.a_(PENPOT.kE,
PENPOT.Ge(c))})}return null},LLb=new PENPOT.x(null,"parent-uri","parent-uri",-371819908);PENPOT.Ta("rasterizer");PENPOT.Gu.set("app.rasterizer",PENPOT.Fu(PENPOT.zj));var tLb=new Map,GLb=""+(PENPOT.Tu??"");PENPOT.na("app.rasterizer.init",MLb);PENPOT.cb();MLb();
}).call(this);
//# sourceMappingURL=rasterizer.accd5226d-1751875088.js.map
